"""
–§–∏–Ω–∞–ª—å–Ω—ã–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç - –ø—Ä–æ—Å—Ç–æ –≤–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π.
–ë–µ–∑ –±—É—Ñ–µ—Ä–∞ –æ–±–º–µ–Ω–∞ - –ø—Ä–æ—Å—Ç–æ –≤–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞.
"""
import time
import pyautogui

def final_visual_test():
    """–§–∏–Ω–∞–ª—å–Ω—ã–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç –ø–æ–ª—è –≤–≤–æ–¥–∞."""
    print("üëÅÔ∏è –§–ò–ù–ê–õ–¨–ù–´–ô –í–ò–ó–£–ê–õ–¨–ù–´–ô –¢–ï–°–¢")
    print("="*60)
    print("üéØ –ü—Ä–æ—Å—Ç–æ –≤–≤–æ–∂—É —Ç–µ–∫—Å—Ç –∏ —Å–º–æ—Ç—Ä—é –∫—É–¥–∞ –æ–Ω –ø–æ–ø–∞–¥–∞–µ—Ç")
    print("üëÄ –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –≥–¥–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–µ–∫—Å—Ç")
    print("‚úÖ –ë–µ–∑ –±—É—Ñ–µ—Ä–∞ –æ–±–º–µ–Ω–∞")
    print("="*60)
    
    screen_width, screen_height = pyautogui.size()
    print(f"üìê –†–∞–∑–º–µ—Ä —ç–∫—Ä–∞–Ω–∞: {screen_width}x{screen_height}")
    
    # –†–∞–∑–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
    test_points = [
        (int(screen_width * 0.85), int(screen_height * 0.92)),  # –°—Ç–∞–Ω–¥–∞—Ä—Ç
        (int(screen_width * 0.80), int(screen_height * 0.92)),  # –õ–µ–≤–µ–µ
        (int(screen_width * 0.90), int(screen_height * 0.92)),  # –ü—Ä–∞–≤–µ–µ
        (int(screen_width * 0.85), int(screen_height * 0.88)),  # –í—ã—à–µ
        (int(screen_width * 0.85), int(screen_height * 0.96)),  # –ù–∏–∂–µ
        (int(screen_width * 0.75), int(screen_height * 0.92)),  # –ï—â–µ –ª–µ–≤–µ–µ
        (int(screen_width * 0.95), int(screen_height * 0.92)),  # –ö—Ä–∞–π —Å–ø—Ä–∞–≤–∞
    ]
    
    print(f"üéØ –ü—Ä–æ–≤–µ—Ä—é {len(test_points)} —Ç–æ—á–µ–∫")
    print("‚ö†Ô∏è –í–ê–ñ–ù–û: –°–º–æ—Ç—Ä–∏—Ç–µ –∫—É–¥–∞ –≤–≤–æ–¥–∏—Ç—Å—è —Ç–µ–∫—Å—Ç!")
    
    for idx, (x, y) in enumerate(test_points):
        print(f"\n{'='*60}")
        print(f"üéØ –¢–û–ß–ö–ê #{idx + 1}/{len(test_points)}")
        print(f"üìç –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: ({x}, {y})")
        print(f"{'='*60}")
        
        try:
            # –®–∞–≥ 1: –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –æ—Ç–∫—Ä—ã—Ç
            print("üìç –®–∞–≥ 1: Alt+A - –æ—Ç–∫—Ä—ã—Ç—å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞...")
            pyautogui.hotkey('alt', 'a')
            time.sleep(2)
            
            # –®–∞–≥ 2: –í–∏–∑—É–∞–ª—å–Ω—ã–π –∫–ª–∏–∫
            print("üìç –®–∞–≥ 2: –ö–ª–∏–∫ –ø–æ —Ç–æ—á–∫–µ...")
            print(f"   üëÅÔ∏è –°–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –∫—É—Ä—Å–æ—Ä –≤ —Ç–æ—á–∫–µ ({x}, {y})")
            
            # –ú–µ–¥–ª–µ–Ω–Ω–æ –¥–≤–∏–≥–∞–µ–º –∫—É—Ä—Å–æ—Ä
            pyautogui.moveTo(x, y, duration=1.0)
            time.sleep(0.5)
            
            # –ö–ª–∏–∫–∞–µ–º
            pyautogui.click(x, y)
            time.sleep(0.5)
            
            # –®–∞–≥ 3: –í–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞
            print("üìç –®–∞–≥ 3: –í–≤–æ–¥ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ç–µ–∫—Å—Ç–∞...")
            test_text = f"FINAL_TEST_{idx + 1}"
            
            # –ü—Ä–æ–±—É–µ–º –æ—á–∏—Å—Ç–∏—Ç—å
            pyautogui.hotkey('ctrl', 'a')
            time.sleep(0.2)
            pyautogui.press('delete')
            time.sleep(0.2)
            
            # –í–≤–æ–¥–∏–º —Ç–µ–∫—Å—Ç –º–µ–¥–ª–µ–Ω–Ω–æ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
            print(f"   üìù –í–≤–æ–∂—É: {test_text}")
            pyautogui.typewrite(test_text, interval=0.1)
            time.sleep(2)
            
            # –®–∞–≥ 4: –í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
            print("üìç –®–∞–≥ 4: –í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞...")
            print(f"   üìù –í–≤–µ–¥–µ–Ω —Ç–µ–∫—Å—Ç: {test_text}")
            print("   üëÄ –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —ç–∫—Ä–∞–Ω:")
            print("      1. –¢–µ–∫—Å—Ç –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ (–Ω–∏–∑ —Å–ø—Ä–∞–≤–∞) ‚úÖ")
            print("      2. –¢–µ–∫—Å—Ç –≤ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞ (–≤–≤–µ—Ä—Ö—É) ‚ùå") 
            print("      3. –¢–µ–∫—Å—Ç –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ ‚ùå")
            print("      4. –¢–µ–∫—Å—Ç –Ω–µ –ø–æ—è–≤–∏–ª—Å—è ‚ùå")
            
            try:
                answer = input("–ì–¥–µ –ø–æ—è–≤–∏–ª—Å—è —Ç–µ–∫—Å—Ç (1-4): ").strip()
                
                if answer == "1":
                    print(f"üéâ –£–°–ü–ï–• –¢–û–ß–ö–ò #{idx + 1}!")
                    print(f"‚úÖ –¢–µ–∫—Å—Ç '{test_text}' –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞!")
                    print(f"üéØ –†–ê–ë–û–ß–ò–ï –ö–û–û–†–î–ò–ù–ê–¢–´: ({x}, {y})")
                    
                    # –û—á–∏—â–∞–µ–º
                    pyautogui.hotkey('ctrl', 'a')
                    time.sleep(0.2)
                    pyautogui.press('delete')
                    time.sleep(0.2)
                    
                    print("="*60)
                    print("üéØ –ó–ê–î–ê–ß–ê –í–´–ü–û–õ–ù–ï–ù–ê!")
                    print("‚úÖ –ù–ê–ô–î–ï–ù–´ –ö–û–û–†–î–ò–ù–ê–¢–´ –ü–û–õ–Ø –í–í–û–î–ê!")
                    print("="*60)
                    return True, (x, y)
                    
                elif answer == "2":
                    print("‚ùå –¢–µ–∫—Å—Ç –≤ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞")
                elif answer == "3":
                    print("‚ùå –¢–µ–∫—Å—Ç –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ")
                elif answer == "4":
                    print("‚ùå –¢–µ–∫—Å—Ç –Ω–µ –ø–æ—è–≤–∏–ª—Å—è")
                else:
                    print("‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç")
                
            except Exception as e:
                print(f"‚ùå –û—à–∏–±–∫–∞ –≤–≤–æ–¥–∞: {e}")
            
            # –û—á–∏—â–∞–µ–º –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–µ–π —Ç–æ—á–∫–æ–π
            try:
                pyautogui.hotkey('ctrl', 'a')
                time.sleep(0.2)
                pyautogui.press('delete')
                time.sleep(0.2)
            except:
                pass
            
            print(f"‚ùå –¢–æ—á–∫–∞ #{idx + 1} –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç")
            time.sleep(1)
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –≤ —Ç–æ—á–∫–µ #{idx + 1}: {e}")
            time.sleep(1)
    
    print(f"\n‚ùå –í–°–ï –¢–û–ß–ö–ò –ü–†–û–í–ï–†–ï–ù–´!")
    print("‚ùå –ü–û–õ–ï –í–í–û–î–ê –ù–ï –ù–ê–ô–î–ï–ù–û!")
    return False, None

if __name__ == "__main__":
    print("üëÅÔ∏è –ó–ê–ü–£–°–ö –§–ò–ù–ê–õ–¨–ù–û–ì–û –í–ò–ó–£–ê–õ–¨–ù–û–ì–û –¢–ï–°–¢–ê")
    print("üéØ –ü—Ä–æ—Å—Ç–æ –≤–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ —Å –≤–∏–∑—É–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π")
    print("üëÄ –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –∫—É–¥–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–µ–∫—Å—Ç")
    print()
    
    print("‚ö†Ô∏è –í–ê–ñ–ù–û:")
    print("   1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Comet –∞–∫—Ç–∏–≤–µ–Ω")
    print("   2. –°–º–æ—Ç—Ä–∏—Ç–µ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –Ω–∞ —ç–∫—Ä–∞–Ω")
    print("   3. –û—Ç–≤–µ—á–∞–π—Ç–µ –∫—É–¥–∞ –≤–≤–æ–¥–∏—Ç—Å—è —Ç–µ–∫—Å—Ç")
    print("   4. –ù–µ –ø–µ—Ä–µ–∫–ª—é—á–∞–π—Ç–µ—Å—å –≤–æ –≤—Ä–µ–º—è —Ç–µ—Å—Ç–∞")
    print()
    
    input("–ù–∞–∂–º–∏—Ç–µ Enter –∫–æ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã...")
    
    success, coordinates = final_visual_test()
    
    if success:
        print("\nüéâ –ú–ò–°–°–ò–Ø –í–´–ü–û–õ–ù–ï–ù–ê!")
        print("‚úÖ –ù–∞–π–¥–µ–Ω—ã –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ–ª—è –≤–≤–æ–¥–∞ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞!")
        print(f"üéØ –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: {coordinates}")
        print("üöÄ –ú–û–ñ–ù–û –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨ –í –û–°–ù–û–í–ù–û–ô –ü–†–û–ì–†–ê–ú–ú–ï!")
    else:
        print("\n‚ùå –ú–ò–°–°–ò–Ø –ü–†–û–í–ê–õ–ï–ù–ê!")
        print("üí° –ü–æ–ª–µ –≤–≤–æ–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ")
        print("üîç –í–æ–∑–º–æ–∂–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å")
    
    print("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")
    try:
        input()
    except:
        pass

"""
–ü–†–û–í–ï–†–ö–ê –ö–ê–ö –£ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø
–î–µ–ª–∞–µ–º —Ç–æ—á–Ω–æ –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: Alt+A –∏ –≤–≤–æ–¥
"""
import pyautogui
import time
import pyperclip
import pygetwindow as gw

# –û—Ç–∫–ª—é—á–∞–µ–º fail-safe
pyautogui.FAILSAFE = False

print('üöÄ –ü–†–û–í–ï–†–ö–ê –ö–ê–ö –£ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø')
print('='*50)
print('üìç –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:')
print('   1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Comet –æ—Ç–∫—Ä—ã—Ç')
print('   2. –ù–∞–∂–º–∏—Ç–µ Enter —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å')
print('   3. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–∞–∂–º–µ—Ç Alt+A')
print('   4. –°—Ä–∞–∑—É –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç')
print('='*50)

input('–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –Ω–∞—á–∞–ª–∞...')

print('\nüîÑ –ù–∞—á–∏–Ω–∞—é —Ç–µ—Å—Ç...')

# –ü—Ä–æ—Å—Ç–æ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –æ–∫–Ω–æ –±–µ–∑ —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
try:
    windows = gw.getWindowsWithTitle('Comet')
    if windows:
        print('‚úÖ –ù–∞–π–¥–µ–Ω–æ –æ–∫–Ω–æ Comet')
        windows[0].activate()
        time.sleep(1)
        print('‚úÖ –û–∫–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ')
    else:
        print('‚ùå –û–∫–Ω–æ Comet –Ω–µ –Ω–∞–π–¥–µ–Ω–æ')
        print('üìç –ü–æ–∂–∞–ª—É–π—Å—Ç–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ Comet –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞')
        exit()
except:
    print('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –æ–∫–Ω–æ, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—é...')

# –ñ–¥–µ–º —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã–ª –≥–æ—Ç–æ–≤
print('‚è≥ –ì–æ—Ç–æ–≤–ª—é—Å—å –∫ Alt+A...')
time.sleep(2)

print('üìç –ù–ê–ñ–ò–ú–ê–Æ ALT+A...')
pyautogui.hotkey('alt', 'a')

print('‚úÖ Alt+A –Ω–∞–∂–∞—Ç–æ!')
print('üìç –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–µ–π—á–∞—Å –≤–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç –≤—Ä—É—á–Ω—É—é')
print('üìç –ï—Å–ª–∏ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –æ—Ç–∫—Ä—ã—Ç - –≤–≤–µ–¥–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å')
print('üìç –ù–∞–∂–º–∏—Ç–µ Enter –∫–æ–≥–¥–∞ –∑–∞–∫–æ–Ω—á–∏—Ç–µ...')

input('–ù–∞–∂–º–∏—Ç–µ Enter –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞...')

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –≤–≤–µ–¥–µ–Ω–æ
print('\nüîç –ü—Ä–æ–≤–µ—Ä—è—é —á—Ç–æ –≤–≤–µ–¥–µ–Ω–æ...')
pyautogui.hotkey('ctrl', 'a')
time.sleep(0.5)
pyautogui.hotkey('ctrl', 'c')
time.sleep(0.5)

clipboard = pyperclip.paste()
print(f'üìã –í –±—É—Ñ–µ—Ä–µ –æ–±–º–µ–Ω–∞: \"{clipboard}\"')

if len(clipboard) > 0 and clipboard != '':
    print('‚úÖ –¢–ï–ö–°–¢ –í–í–ï–î–ï–ù! –ê–°–°–ò–°–¢–ï–ù–¢ –†–ê–ë–û–¢–ê–ï–¢!')
    
    # –¢–µ–ø–µ—Ä—å –ø—Ä–æ–±—É–µ–º –∞–≤—Ç–æ–º–∞—Ç–æ–º
    print('\nüîÑ –¢–µ–ø–µ—Ä—å –ø—Ä–æ–±—É—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–≤–æ–¥...')
    
    pyautogui.hotkey('ctrl', 'a')
    time.sleep(0.5)
    pyautogui.press('delete')
    time.sleep(0.5)
    
    print('üìç –í–≤–æ–∂—É AUTOMATED_TEST...')
    pyautogui.typewrite('AUTOMATED_TEST', interval=0.05)
    time.sleep(1)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º
    pyautogui.hotkey('ctrl', 'a')
    time.sleep(0.5)
    pyautogui.hotkey('ctrl', 'c')
    time.sleep(0.5)
    
    clipboard = pyperclip.paste()
    print(f'üìã –ü–æ—Å–ª–µ –∞–≤—Ç–æ-–≤–≤–æ–¥–∞: \"{clipboard}\"')
    
    if 'AUTOMATED_TEST' in clipboard:
        print('‚úÖ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô –í–í–û–î –†–ê–ë–û–¢–ê–ï–¢!')
        print('üéâ –ü–†–û–ë–õ–ï–ú–ê –ë–´–õ–ê –í –í–†–ï–ú–ï–ù–ò –û–ñ–ò–î–ê–ù–ò–Ø!')
    else:
        print('‚ùå –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–≤–æ–¥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç')
        print('üí° –ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∑–∞–¥–µ—Ä–∂–∫—É')
else:
    print('‚ùå –ù–∏—á–µ–≥–æ –Ω–µ –≤–≤–µ–¥–µ–Ω–æ')
    print('üí° –í–æ–∑–º–æ–∂–Ω–æ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –Ω–µ –æ—Ç–∫—Ä—ã–ª—Å—è')

print('\nüìä –†–ï–ó–£–õ–¨–¢–ê–¢ –¢–ï–°–¢–ê:')
print('‚úÖ Alt+A –Ω–∞–∂–∞—Ç')
print(f'üìã –ë—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞: \"{clipboard}\"')
print('üìç –ï—Å–ª–∏ —É –≤–∞—Å —Ä–∞–±–æ—Ç–∞–µ—Ç - –∑–Ω–∞—á–∏—Ç –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–∞–π–º–∏–Ω–≥–∞—Ö –ø—Ä–æ–≥—Ä–∞–º–º—ã')

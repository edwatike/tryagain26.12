"""
–¢–ï–°–¢ –†–£–ß–ù–û–ì–û –û–¢–ö–†–´–¢–ò–Ø –ê–°–°–ò–°–¢–ï–ù–¢–ê
"""
import pyautogui
import time
import pyperclip

# –û—Ç–∫–ª—é—á–∞–µ–º fail-safe
pyautogui.FAILSAFE = False

print('üîç –¢–ï–°–¢ –†–£–ß–ù–û–ì–û –û–¢–ö–†–´–¢–ò–Ø –ê–°–°–ò–°–¢–ï–ù–¢–ê')
print('='*50)
print('üìç –ò–ù–°–¢–†–£–ö–¶–ò–Ø:')
print('   1. –û—Ç–∫—Ä–æ–π—Ç–µ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –≤—Ä—É—á–Ω—É—é (–∫–∞–∫ –≤—ã –æ–±—ã—á–Ω–æ –¥–µ–ª–∞–µ—Ç–µ)')
print('   2. –ö–æ–≥–¥–∞ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –æ—Ç–∫—Ä—ã—Ç - –Ω–∞–∂–º–∏—Ç–µ Enter')
print('   3. –Ø –ø—Ä–æ–≤–µ—Ä—é —Å–º–æ–≥—É –ª–∏ –≤–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç')
print('='*50)

input('–ù–∞–∂–º–∏—Ç–µ Enter –∫–æ–≥–¥–∞ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –æ—Ç–∫—Ä—ã—Ç...')

print('\nüîÑ –ü—Ä–æ–≤–µ—Ä—è—é –≤–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞...')

# –ü—Ä–æ–±—É–µ–º –≤–≤–µ—Å—Ç–∏ –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö
positions = [
    (1632, 993),  # –ü—Ä–∞–≤—ã–π –Ω–∏–∂–Ω–∏–π —É–≥–æ–ª
    (960, 540),   # –¶–µ–Ω—Ç—Ä
    (1728, 540),  # –°–ø—Ä–∞–≤–∞ —Ü–µ–Ω—Ç—Ä
    (1200, 800),  # –ü—Ä–∞–≤–æ-–Ω–∏–∑
]

for i, (x, y) in enumerate(positions):
    print(f'üîÑ –¢–µ—Å—Ç {i+1}/{len(positions)}: –∫–ª–∏–∫ –≤ ({x}, {y})')
    
    # –ö–ª–∏–∫
    pyautogui.click(x, y)
    time.sleep(1)
    
    # –í–≤–æ–¥–∏–º
    pyautogui.hotkey('ctrl', 'a')
    time.sleep(0.5)
    pyautogui.press('delete')
    time.sleep(0.5)
    pyautogui.typewrite('AUTO_TEST', interval=0.1)
    time.sleep(2)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º
    pyautogui.hotkey('ctrl', 'a')
    time.sleep(0.5)
    pyautogui.hotkey('ctrl', 'c')
    time.sleep(0.5)
    
    clipboard = pyperclip.paste()
    print(f'   üìã –†–µ–∑—É–ª—å—Ç–∞—Ç: \"{clipboard}\"')
    
    if 'AUTO_TEST' in clipboard:
        print(f'   ‚úÖ –£–°–ü–ï–•! –í–≤–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø–æ–∑–∏—Ü–∏–∏ ({x}, {y})!')
        print(f'   üéâ –ù–ê–ô–î–ï–ù–ê –†–ê–ë–û–ß–ê–Ø –ü–û–ó–ò–¶–ò–Ø!')
        
        # –¢–µ–ø–µ—Ä—å –ø—Ä–æ–±—É–µ–º –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª
        print('\nüîÑ –¢–µ–ø–µ—Ä—å –ø—Ä–æ–±—É—é –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å —ç—Ç–æ–π –ø–æ–∑–∏—Ü–∏–µ–π...')
        
        # –ó–∞–∫—Ä—ã–≤–∞–µ–º –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç
        pyautogui.press('escape')
        time.sleep(2)
        
        # –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å–Ω–æ–≤–∞
        print('üìç –û—Ç–∫—Ä—ã–≤–∞—é –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å–Ω–æ–≤–∞...')
        pyautogui.hotkey('alt', 'a')
        time.sleep(3)
        
        # –ö–ª–∏–∫ –≤ —Ä–∞–±–æ—á—É—é –ø–æ–∑–∏—Ü–∏—é
        print(f'üìç –ö–ª–∏–∫ –≤ —Ä–∞–±–æ—á—É—é –ø–æ–∑–∏—Ü–∏—é ({x}, {y})...')
        pyautogui.click(x, y)
        time.sleep(1)
        
        # –í–≤–æ–¥–∏–º –ø—Ä–æ–º–ø—Ç
        prompt = '–ù–∞–π–¥–∏ –ò–ù–ù –∏ email –¥–ª—è —ç—Ç–æ–≥–æ —Å–∞–π—Ç–∞'
        print(f'üìç –í–≤–æ–∂—É –ø—Ä–æ–º–ø—Ç: {prompt}')
        pyautogui.typewrite(prompt, interval=0.05)
        time.sleep(1)
        
        # Enter
        print('üìç Enter...')
        pyautogui.press('enter')
        time.sleep(1)
        
        print('‚úÖ –ü—Ä–æ–º–ø—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!')
        break
    else:
        print('   ‚ùå –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç')

print('\nüìç –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω')

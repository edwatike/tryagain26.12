# Чеклисты для разных типов задач

**Дата создания:** 2025-12-29  
**Цель:** Стандартизировать процесс работы для разных типов задач, обеспечить полноту работы и качество результата.

## Общие правила

**Перед началом ЛЮБОЙ задачи:**
1. ✅ Проверить состояние системы: `.\scripts\quick-check.ps1 all`
2. ✅ Прочитать документацию в `docs/CRITICAL_INTEGRATION_POINTS.md` (если применимо)
3. ✅ Найти все места использования через `grep` и `codebase_search`
4. ✅ Проанализировать влияние изменений

**После завершения ЛЮБОЙ задачи:**
1. ✅ Запустить проверки: `.\scripts\quick-check.ps1 all`
2. ✅ Проверить на реальном фронтенде (если применимо)
3. ✅ Проверить консоль браузера и Network tab (если применимо)
4. ✅ Обновить документацию (если нужно)

## 1. Изменение API endpoint

### Перед изменением

- [ ] Проверить состояние системы: `.\scripts\quick-check.ps1 all`
- [ ] Найти все места использования endpoint:
  ```powershell
  grep -r "endpointName" frontend/ backend/
  codebase_search "Where is endpointName used?"
  ```
- [ ] Прочитать документацию в `docs/CRITICAL_INTEGRATION_POINTS.md` (если endpoint используется в нескольких местах)
- [ ] Проверить существующие типы в `frontend/moderator-dashboard-ui/lib/types.ts`
- [ ] Проверить существующие функции в `frontend/moderator-dashboard-ui/lib/api.ts`
- [ ] Проанализировать влияние изменений на другие части системы

### Во время изменения

- [ ] Изменить endpoint в Backend (`backend/app/transport/routers/`)
- [ ] Обновить Pydantic схемы (`backend/app/transport/schemas/`)
- [ ] Обновить usecase (`backend/app/usecases/`)
- [ ] Обновить типы в Frontend (`frontend/moderator-dashboard-ui/lib/types.ts`)
- [ ] Обновить функции в Frontend (`frontend/moderator-dashboard-ui/lib/api.ts`)
- [ ] Обновить компоненты, использующие endpoint

### После изменения

- [ ] Запустить проверки:
  ```powershell
  .\scripts\quick-check.ps1 all
  python temp/backend/check_imports.py  # для Backend
  cd frontend/moderator-dashboard-ui && npm run lint  # для Frontend
  ```
- [ ] Проверить endpoint через API:
  ```powershell
  curl http://127.0.0.1:8000/docs  # проверить Swagger
  curl http://127.0.0.1:8000/endpoint  # проверить endpoint
  ```
- [ ] Проверить на реальном фронтенде:
  - Открыть страницу, использующую endpoint
  - Выполнить операцию, которая вызывает endpoint
  - Проверить результат
- [ ] Проверить консоль браузера (F12) на наличие ошибок
- [ ] Проверить Network tab на наличие ошибок API запросов
- [ ] Обновить документацию:
  - `docs/PROJECT_SPECIFICATION.md` (если endpoint новый или изменен)
  - `docs/CRITICAL_INTEGRATION_POINTS.md` (если endpoint используется в нескольких местах)

## 2. Изменение UI компонента

### Перед изменением

- [ ] Проверить состояние системы: `.\scripts\quick-check.ps1 all`
- [ ] Найти все места использования компонента:
  ```powershell
  grep -r "ComponentName" frontend/
  codebase_search "Where is ComponentName used?"
  ```
- [ ] Прочитать документацию в `docs/CRITICAL_INTEGRATION_POINTS.md` (если компонент используется в нескольких местах)
- [ ] Проверить зависимости компонента (props, типы, утилиты)
- [ ] Проанализировать влияние изменений на другие компоненты

### Во время изменения

- [ ] Изменить компонент
- [ ] Обновить типы (если нужно)
- [ ] Обновить стили (если нужно)
- [ ] Обновить зависимости (если нужно)

### После изменения

- [ ] Запустить проверки:
  ```powershell
  .\scripts\quick-check.ps1 all
  cd frontend/moderator-dashboard-ui && npm run lint
  ```
- [ ] Проверить на реальном фронтенде:
  - Открыть страницу с компонентом
  - Проверить отображение компонента
  - Проверить интерактивность компонента
  - Проверить на разных размерах экрана (если применимо)
- [ ] Проверить консоль браузера (F12) на наличие ошибок
- [ ] Проверить Network tab на наличие ошибок API запросов
- [ ] Обновить документацию (если нужно)

## 3. Исправление ошибки

### Перед исправлением

- [ ] Проверить состояние системы: `.\scripts\quick-check.ps1 all`
- [ ] Выполнить чеклист диагностики из `docs/TROUBLESHOOTING.md` раздел "7. Чеклист диагностики"
- [ ] Проверить логи сервисов:
  ```powershell
  Get-Content "logs\Backend-*.log" -Tail 50 | Select-String -Pattern "ERROR|Exception|Traceback"
  Get-Content "logs\Parser Service-*.log" -Tail 50 | Select-String -Pattern "ERROR|Exception|Traceback"
  ```
- [ ] Проверить `docs/TROUBLESHOOTING.md` на наличие похожих проблем
- [ ] Прочитать раздел "ОБЯЗАТЕЛЬНЫЕ ПРОВЕРКИ" из `docs/TROUBLESHOOTING.md`
- [ ] Найти причину ошибки (использовать логи, документацию, тесты)

### Во время исправления

- [ ] Исправить ошибку
- [ ] Убедиться, что исправление не ломает другие части системы
- [ ] Проверить все места использования исправленного кода

### После исправления

- [ ] Запустить проверки:
  ```powershell
  .\scripts\quick-check.ps1 all
  python temp/backend/check_imports.py  # для Backend
  cd frontend/moderator-dashboard-ui && npm run lint  # для Frontend
  ```
- [ ] Проверить на реальном фронтенде:
  - Открыть страницу, где была ошибка
  - Выполнить операцию, которая вызывала ошибку
  - Убедиться, что ошибка исправлена
- [ ] Проверить консоль браузера (F12) на наличие ошибок
- [ ] Проверить Network tab на наличие ошибок API запросов
- [ ] Задокументировать решение в `docs/TROUBLESHOOTING.md`:
  - Использовать шаблон `temp/templates/troubleshooting_template.md`
  - Описать проблему, причину, решение, проверку
  - Указать измененные файлы и дату решения

## 4. Добавление новой функциональности

### Перед добавлением

- [ ] Проверить состояние системы: `.\scripts\quick-check.ps1 all`
- [ ] Изучить архитектуру проекта через `docs/PROJECT_MAP.md`
- [ ] Прочитать документацию в `docs/CRITICAL_INTEGRATION_POINTS.md` (если функциональность будет использоваться в нескольких местах)
- [ ] Определить, где разместить новую функциональность:
  - Backend: роутер, usecase, adapter, модель
  - Frontend: страница, компонент, утилита
- [ ] Проанализировать влияние на существующую функциональность

### Во время добавления

- [ ] Создать необходимые файлы (роутер, usecase, компонент и т.д.)
- [ ] Реализовать функциональность
- [ ] Обновить типы (Backend и Frontend)
- [ ] Обновить API клиент (Frontend)
- [ ] Добавить обработку ошибок

### После добавления

- [ ] Запустить проверки:
  ```powershell
  .\scripts\quick-check.ps1 all
  python temp/backend/check_imports.py  # для Backend
  cd frontend/moderator-dashboard-ui && npm run lint  # для Frontend
  ```
- [ ] Проверить на реальном фронтенде:
  - Открыть страницу с новой функциональностью
  - Выполнить операции новой функциональности
  - Проверить результат
- [ ] Проверить консоль браузера (F12) на наличие ошибок
- [ ] Проверить Network tab на наличие ошибок API запросов
- [ ] Обновить документацию:
  - `docs/PROJECT_SPECIFICATION.md` (если добавлена новая связка Backend-Frontend)
  - `docs/CRITICAL_INTEGRATION_POINTS.md` (если функциональность используется в нескольких местах)
  - `docs/PROJECT_MAP.md` (если добавлены новые файлы/директории)

## 5. Изменение логики определения источников (Google/Яндекс)

### Перед изменением

- [ ] Проверить состояние системы: `.\scripts\quick-check.ps1 all`
- [ ] Прочитать `docs/SOURCE_DETERMINATION_FLOW.md` - полное описание потока данных
- [ ] Прочитать `docs/CRITICAL_INTEGRATION_POINTS.md` раздел "5.1 Определение источников для доменов"
- [ ] Найти все места использования:
  ```powershell
  grep -r "collectDomainSources\|normalizeUrl\|parsing_logs" frontend/
  codebase_search "Where is source determination logic used?"
  ```
- [ ] Проанализировать влияние изменений на отображение бейджей

### Во время изменения

- [ ] Изменить логику в `frontend/moderator-dashboard-ui/lib/utils-domain.ts`
- [ ] Обновить использование в компонентах (если нужно)
- [ ] Убедиться, что нормализация URL работает корректно

### После изменения

- [ ] Запустить проверки:
  ```powershell
  .\scripts\quick-check.ps1 all
  cd frontend/moderator-dashboard-ui && npm run lint
  ```
- [ ] Проверить на реальном фронтенде:
  - Открыть страницу результатов парсинга
  - Проверить, что бейджи Google/Яндекс отображаются корректно
  - Проверить, что источники определяются правильно для каждого домена
- [ ] Проверить консоль браузера (F12) на наличие ошибок
- [ ] Проверить Network tab на наличие ошибок API запросов
- [ ] Обновить документацию:
  - `docs/SOURCE_DETERMINATION_FLOW.md` (если изменился поток данных)
  - `docs/CRITICAL_INTEGRATION_POINTS.md` (если изменились правила реализации)

## 6. Изменение фильтрации blacklist

### Перед изменением

- [ ] Проверить состояние системы: `.\scripts\quick-check.ps1 all`
- [ ] Прочитать `docs/CRITICAL_INTEGRATION_POINTS.md` раздел "1. Blacklist фильтрация"
- [ ] Найти все места использования:
  ```powershell
  grep -r "blacklist\|blacklisted" frontend/
  codebase_search "Where is blacklist filtering used?"
  ```
- [ ] Проанализировать влияние изменений на отображение результатов

### Во время изменения

- [ ] Изменить логику фильтрации
- [ ] Убедиться, что фильтрация происходит ПЕРЕД группировкой
- [ ] Убедиться, что blacklist всегда загружается свежим

### После изменения

- [ ] Запустить проверки:
  ```powershell
  .\scripts\quick-check.ps1 all
  cd frontend/moderator-dashboard-ui && npm run lint
  ```
- [ ] Проверить на реальном фронтенде:
  - Открыть страницу результатов парсинга
  - Добавить домен в blacklist
  - Проверить, что домен исчезает из результатов
  - Проверить на всех страницах, где используется blacklist
- [ ] Проверить консоль браузера (F12) на наличие ошибок
- [ ] Проверить Network tab на наличие ошибок API запросов
- [ ] Обновить документацию (если изменились правила реализации)

## 7. Изменение группировки доменов

### Перед изменением

- [ ] Проверить состояние системы: `.\scripts\quick-check.ps1 all`
- [ ] Прочитать `docs/CRITICAL_INTEGRATION_POINTS.md` раздел "3. Группировка доменов"
- [ ] Найти все места использования:
  ```powershell
  grep -r "groupByDomain" frontend/
  codebase_search "Where is domain grouping used?"
  ```
- [ ] Проанализировать влияние изменений на отображение результатов

### Во время изменения

- [ ] Изменить логику группировки в `frontend/moderator-dashboard-ui/lib/utils-domain.ts`
- [ ] Обновить использование в компонентах (если нужно)
- [ ] Убедиться, что группировка работает корректно

### После изменения

- [ ] Запустить проверки:
  ```powershell
  .\scripts\quick-check.ps1 all
  cd frontend/moderator-dashboard-ui && npm run lint
  ```
- [ ] Проверить на реальном фронтенде:
  - Открыть страницу результатов парсинга
  - Проверить, что домены группируются корректно
  - Проверить на всех страницах, где используется группировка
- [ ] Проверить консоль браузера (F12) на наличие ошибок
- [ ] Проверить Network tab на наличие ошибок API запросов
- [ ] Обновить документацию (если изменились правила реализации)

## 8. Изменение парсера (Parser Service)

### Перед изменением

- [ ] Проверить состояние системы: `.\scripts\quick-check.ps1 all`
- [ ] Проверить, что Chrome CDP запущен: `curl http://127.0.0.1:9222/json/version`
- [ ] Прочитать документацию парсера в `parser_service/README_PROFILE.md`
- [ ] Найти все места использования:
  ```powershell
  grep -r "parser\|parsing" backend/ frontend/
  codebase_search "Where is parser service used?"
  ```
- [ ] Проанализировать влияние изменений на результаты парсинга

### Во время изменения

- [ ] Изменить код парсера
- [ ] Убедиться, что логи парсинга обновляются корректно
- [ ] Убедиться, что источники определяются корректно

### После изменения

- [ ] Перезапустить Parser Service
- [ ] Запустить проверки:
  ```powershell
  .\scripts\quick-check.ps1 all
  curl http://127.0.0.1:9003/health
  ```
- [ ] Проверить на реальном фронтенде:
  - Запустить парсинг
  - Проверить, что парсинг работает корректно
  - Проверить, что логи обновляются в реальном времени
  - Проверить, что результаты отображаются корректно
- [ ] Проверить консоль браузера (F12) на наличие ошибок
- [ ] Проверить Network tab на наличие ошибок API запросов
- [ ] Проверить логи Parser Service на наличие ошибок
- [ ] Обновить документацию (если нужно)

## Общие рекомендации

1. **Всегда проверяй состояние системы перед началом работы**
2. **Всегда проверяй результаты на реальном фронтенде после изменений**
3. **Всегда используй карту проекта для понимания структуры**
4. **Всегда анализируй влияние изменений перед их выполнением**
5. **Всегда используй инструменты автоматизации для проверки качества**
6. **Всегда документируй с использованием шаблонов**

## Связанные документы

- [AI_AGENT_IMPROVEMENTS.md](AI_AGENT_IMPROVEMENTS.md) - рекомендации по улучшению работы AI
- [CRITICAL_INTEGRATION_POINTS.md](CRITICAL_INTEGRATION_POINTS.md) - критические точки интеграции
- [SOURCE_DETERMINATION_FLOW.md](SOURCE_DETERMINATION_FLOW.md) - поток данных
- [TROUBLESHOOTING.md](TROUBLESHOOTING.md) - библия ошибок
- [PROJECT_MAP.md](PROJECT_MAP.md) - карта проекта



